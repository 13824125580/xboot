/*
 * xboot/kernel/command/cmd_test.c
 */

#include <configs.h>
#include <default.h>
#include <types.h>
#include <string.h>
#include <malloc.h>
#include <rand.h>
#include <div64.h>
#include <fifo.h>
#include <vsprintf.h>
#include <byteorder.h>
#include <sha.h>
#include <xml.h>
#include <time/delay.h>
#include <time/timer.h>
#include <time/xtime.h>
#include <time/tick.h>
#include <xboot/list.h>
#include <xboot/io.h>
#include <xboot/log.h>
#include <xboot/irq.h>
#include <xboot/printk.h>
#include <xboot/scank.h>
#include <xboot/initcall.h>
#include <xboot/resource.h>
#include <xboot/chrdev.h>
#include <shell/env.h>
#include <shell/command.h>
#include <fb/fb.h>
#include <loop/loop.h>
#include <fb/graphic.h>
#include <fb/logo.h>
#include <rtc/rtc.h>
#include <xboot/proc.h>
#include <terminal/terminal.h>
#include <terminal/curses.h>
#include <mmc/mmc.h>
#include <mmc/mmc_host.h>
#include <fs/vfs/vfs.h>
#include <fs/fsapi.h>


#if	defined(CONFIG_COMMAND_TEST) && (CONFIG_COMMAND_TEST > 0)

static const x_u8 test_ar[2644] = {
	0x21, 0x3c, 0x61, 0x72, 0x63, 0x68, 0x3e, 0x0a, 0x74, 0x74,
	0x74, 0x2e, 0x74, 0x78, 0x74, 0x2f, 0x20, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x31, 0x32, 0x36, 0x34, 0x30, 0x34,
	0x33, 0x30, 0x38, 0x37, 0x20, 0x20, 0x31, 0x30, 0x30, 0x30,
	0x20, 0x20, 0x31, 0x30, 0x30, 0x30, 0x20, 0x20, 0x31, 0x30,
	0x30, 0x36, 0x34, 0x34, 0x20, 0x20, 0x31, 0x35, 0x34, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x60, 0x0a, 0x69, 0x6e,
	0x20, 0x50, 0x61, 0x77, 0x6e, 0x2c, 0x20, 0x61, 0x6e, 0x64,
	0x20, 0x70, 0x72, 0x6f, 0x76, 0x69, 0x64, 0x65, 0x64, 0x20,
	0x70, 0x61, 0x74, 0x63, 0x68, 0x65, 0x73, 0x20, 0x61, 0x6e,
	0x64, 0x20, 0x64, 0x65, 0x74, 0x61, 0x69, 0x6c, 0x65, 0x64,
	0x20, 0x72, 0x65, 0x70, 0x6f, 0x72, 0x74, 0x73, 0x2e, 0x20,
	0x48, 0x65, 0x20, 0x61, 0x6e, 0x64, 0x20, 0x68, 0x69, 0x73,
	0x20, 0x74, 0x65, 0x61, 0x6d, 0x20, 0x61, 0x6c, 0x73, 0x6f,
	0x20, 0x70, 0x72, 0x6f, 0x76, 0x69, 0x64, 0x65, 0x64, 0x20,
	0x61, 0x20, 0x6e, 0x65, 0x77, 0x20, 0x22, 0x6d, 0x65, 0x6d,
	0x6f, 0x72, 0x79, 0x20, 0x66, 0x69, 0x6c, 0x65, 0x22, 0x20,
	0x6d, 0x6f, 0x64, 0x75, 0x6c, 0x65, 0x20, 0x74, 0x68, 0x61,
	0x74, 0x20, 0x6d, 0x61, 0x6b, 0x65, 0x20, 0x74, 0x68, 0x65,
	0x20, 0x63, 0x6f, 0x6d, 0x70, 0x69, 0x6c, 0x65, 0x72, 0x20,
	0x70, 0x72, 0x6f, 0x63, 0x65, 0x73, 0x73, 0x20, 0x6c, 0x61,
	0x72, 0x67, 0x65, 0x20, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74,
	0x73, 0x0a, 0x62, 0x62, 0x2e, 0x74, 0x78, 0x74, 0x2f, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x31, 0x32,
	0x36, 0x34, 0x30, 0x34, 0x33, 0x30, 0x36, 0x38, 0x20, 0x20,
	0x31, 0x30, 0x30, 0x30, 0x20, 0x20, 0x31, 0x30, 0x30, 0x30,
	0x20, 0x20, 0x31, 0x30, 0x30, 0x36, 0x34, 0x34, 0x20, 0x20,
	0x37, 0x38, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
	0x60, 0x0a, 0x54, 0x68, 0x69, 0x73, 0x20, 0x77, 0x6f, 0x72,
	0x6b, 0x20, 0x69, 0x73, 0x20, 0x62, 0x61, 0x73, 0x65, 0x64,
	0x20, 0x6f, 0x6e, 0x20, 0x74, 0x68, 0x65, 0x20, 0x22, 0x53,
	0x6d, 0x61, 0x6c, 0x6c, 0x20, 0x43, 0x20, 0x43, 0x6f, 0x6d,
	0x70, 0x69, 0x6c, 0x65, 0x72, 0x22, 0x20, 0x62, 0x79, 0x20,
	0x52, 0x6f, 0x6e, 0x20, 0x43, 0x61, 0x69, 0x6e, 0x20, 0x61,
	0x6e, 0x64, 0x20, 0x4a, 0x61, 0x6d, 0x65, 0x73, 0x20, 0x45,
	0x2e, 0x20, 0x48, 0x65, 0x6e, 0x64, 0x72, 0x69, 0x78, 0x0a,
	0x61, 0x62, 0x63, 0x2e, 0x74, 0x78, 0x74, 0x2f, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x31, 0x32, 0x36, 0x34,
	0x30, 0x34, 0x33, 0x30, 0x34, 0x30, 0x20, 0x20, 0x31, 0x30,
	0x30, 0x30, 0x20, 0x20, 0x31, 0x30, 0x30, 0x30, 0x20, 0x20,
	0x31, 0x30, 0x30, 0x36, 0x34, 0x34, 0x20, 0x20, 0x36, 0x36,
	0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x60, 0x0a,
	0x54, 0x68, 0x65, 0x20, 0x4a, 0x75, 0x73, 0x74, 0x2d, 0x49,
	0x6e, 0x2d, 0x54, 0x69, 0x6d, 0x65, 0x20, 0x63, 0x6f, 0x6d,
	0x70, 0x69, 0x6c, 0x65, 0x72, 0x20, 0x28, 0x4a, 0x49, 0x54,
	0x29, 0x20, 0x69, 0x6e, 0x63, 0x6c, 0x75, 0x64, 0x65, 0x64,
	0x20, 0x69, 0x6e, 0x20, 0x74, 0x68, 0x69, 0x73, 0x20, 0x72,
	0x65, 0x6c, 0x65, 0x61, 0x73, 0x65, 0x20, 0x77, 0x61, 0x73,
	0x20, 0x61, 0x6c, 0x73, 0x6f, 0x0a, 0x6e, 0x6f, 0x74, 0x69,
	0x63, 0x65, 0x2e, 0x74, 0x78, 0x74, 0x2f, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x31, 0x32, 0x34, 0x35, 0x32, 0x34, 0x31, 0x31,
	0x37, 0x36, 0x20, 0x20, 0x31, 0x30, 0x30, 0x30, 0x20, 0x20,
	0x31, 0x30, 0x30, 0x30, 0x20, 0x20, 0x31, 0x30, 0x30, 0x36,
	0x34, 0x34, 0x20, 0x20, 0x32, 0x30, 0x39, 0x37, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x60, 0x0a, 0x54, 0x68, 0x69, 0x73,
	0x20, 0x77, 0x6f, 0x72, 0x6b, 0x20, 0x69, 0x73, 0x20, 0x62,
	0x61, 0x73, 0x65, 0x64, 0x20, 0x6f, 0x6e, 0x20, 0x74, 0x68,
	0x65, 0x20, 0x22, 0x53, 0x6d, 0x61, 0x6c, 0x6c, 0x20, 0x43,
	0x20, 0x43, 0x6f, 0x6d, 0x70, 0x69, 0x6c, 0x65, 0x72, 0x22,
	0x20, 0x62, 0x79, 0x20, 0x52, 0x6f, 0x6e, 0x20, 0x43, 0x61,
	0x69, 0x6e, 0x20, 0x61, 0x6e, 0x64, 0x20, 0x4a, 0x61, 0x6d,
	0x65, 0x73, 0x20, 0x45, 0x2e, 0x20, 0x48, 0x65, 0x6e, 0x64,
	0x72, 0x69, 0x78, 0x2c, 0x0d, 0x0a, 0x61, 0x73, 0x20, 0x70,
	0x75, 0x62, 0x6c, 0x69, 0x73, 0x68, 0x65, 0x64, 0x20, 0x69,
	0x6e, 0x20, 0x74, 0x68, 0x65, 0x20, 0x62, 0x6f, 0x6f, 0x6b,
	0x20, 0x22, 0x44, 0x72, 0x2e, 0x20, 0x44, 0x6f, 0x62, 0x62,
	0x27, 0x73, 0x20, 0x54, 0x6f, 0x6f, 0x6c, 0x62, 0x6f, 0x6f,
	0x6b, 0x20, 0x6f, 0x66, 0x20, 0x43, 0x22, 0x2c, 0x20, 0x42,
	0x72, 0x61, 0x64, 0x79, 0x20, 0x42, 0x6f, 0x6f, 0x6b, 0x73,
	0x2c, 0x20, 0x31, 0x39, 0x38, 0x36, 0x2e, 0x0d, 0x0a, 0x0d,
	0x0a, 0x54, 0x68, 0x65, 0x20, 0x61, 0x73, 0x73, 0x65, 0x6d,
	0x62, 0x6c, 0x65, 0x72, 0x20, 0x76, 0x65, 0x72, 0x73, 0x69,
	0x6f, 0x6e, 0x20, 0x6f, 0x66, 0x20, 0x74, 0x68, 0x65, 0x20,
	0x61, 0x62, 0x73, 0x74, 0x72, 0x61, 0x63, 0x74, 0x20, 0x6d,
	0x61, 0x63, 0x68, 0x69, 0x6e, 0x65, 0x20, 0x28, 0x66, 0x69,
	0x76, 0x65, 0x20, 0x74, 0x69, 0x6d, 0x65, 0x73, 0x20, 0x66,
	0x61, 0x73, 0x74, 0x65, 0x72, 0x20, 0x74, 0x68, 0x61, 0x6e,
	0x20, 0x74, 0x68, 0x65, 0x20, 0x41, 0x4e, 0x53, 0x49, 0x0d,
	0x0a, 0x43, 0x20, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e,
	0x20, 0x61, 0x6e, 0x64, 0x20, 0x6f, 0x76, 0x65, 0x72, 0x20,
	0x74, 0x77, 0x6f, 0x20, 0x74, 0x69, 0x6d, 0x65, 0x73, 0x20,
	0x66, 0x61, 0x73, 0x74, 0x65, 0x72, 0x20, 0x74, 0x68, 0x61,
	0x6e, 0x20, 0x74, 0x68, 0x65, 0x20, 0x47, 0x4e, 0x55, 0x20,
	0x43, 0x20, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x29,
	0x20, 0x77, 0x61, 0x73, 0x20, 0x6f, 0x72, 0x69, 0x67, 0x69,
	0x6e, 0x61, 0x6c, 0x6c, 0x79, 0x0d, 0x0a, 0x77, 0x72, 0x69,
	0x74, 0x74, 0x65, 0x6e, 0x20, 0x62, 0x79, 0x20, 0x4d, 0x61,
	0x72, 0x63, 0x20, 0x50, 0x65, 0x74, 0x65, 0x72, 0x20, 0x28,
	0x6d, 0x61, 0x63, 0x70, 0x65, 0x74, 0x65, 0x40, 0x67, 0x6d,
	0x78, 0x2e, 0x64, 0x65, 0x29, 0x2e, 0x0d, 0x0a, 0x0d, 0x0a,
	0x54, 0x68, 0x65, 0x20, 0x4a, 0x75, 0x73, 0x74, 0x2d, 0x49,
	0x6e, 0x2d, 0x54, 0x69, 0x6d, 0x65, 0x20, 0x63, 0x6f, 0x6d,
	0x70, 0x69, 0x6c, 0x65, 0x72, 0x20, 0x28, 0x4a, 0x49, 0x54,
	0x29, 0x20, 0x69, 0x6e, 0x63, 0x6c, 0x75, 0x64, 0x65, 0x64,
	0x20, 0x69, 0x6e, 0x20, 0x74, 0x68, 0x69, 0x73, 0x20, 0x72,
	0x65, 0x6c, 0x65, 0x61, 0x73, 0x65, 0x20, 0x77, 0x61, 0x73,
	0x20, 0x61, 0x6c, 0x73, 0x6f, 0x20, 0x77, 0x72, 0x69, 0x74,
	0x74, 0x65, 0x6e, 0x20, 0x62, 0x79, 0x0d, 0x0a, 0x4d, 0x61,
	0x72, 0x63, 0x20, 0x50, 0x65, 0x74, 0x65, 0x72, 0x2e, 0x20,
	0x41, 0x73, 0x20, 0x69, 0x73, 0x20, 0x61, 0x70, 0x70, 0x61,
	0x72, 0x65, 0x6e, 0x74, 0x20, 0x66, 0x72, 0x6f, 0x6d, 0x20,
	0x74, 0x68, 0x65, 0x20, 0x73, 0x6f, 0x75, 0x72, 0x63, 0x65,
	0x20, 0x63, 0x6f, 0x64, 0x65, 0x2c, 0x20, 0x74, 0x68, 0x65,
	0x20, 0x4a, 0x49, 0x54, 0x20, 0x69, 0x73, 0x20, 0x61, 0x6e,
	0x20, 0x65, 0x76, 0x6f, 0x6c, 0x75, 0x74, 0x69, 0x6f, 0x6e,
	0x61, 0x72, 0x79, 0x0d, 0x0a, 0x73, 0x74, 0x65, 0x70, 0x20,
	0x66, 0x72, 0x6f, 0x6d, 0x20, 0x68, 0x69, 0x73, 0x20, 0x65,
	0x61, 0x72, 0x6c, 0x69, 0x65, 0x72, 0x20, 0x61, 0x62, 0x73,
	0x74, 0x72, 0x61, 0x63, 0x74, 0x20, 0x6d, 0x61, 0x63, 0x68,
	0x69, 0x6e, 0x65, 0x2e, 0x20, 0x54, 0x68, 0x65, 0x20, 0x61,
	0x62, 0x73, 0x74, 0x72, 0x61, 0x63, 0x74, 0x20, 0x6d, 0x61,
	0x63, 0x68, 0x69, 0x6e, 0x65, 0x20, 0x68, 0x61, 0x73, 0x20,
	0x65, 0x76, 0x6f, 0x6c, 0x76, 0x65, 0x64, 0x0d, 0x0a, 0x73,
	0x6c, 0x69, 0x67, 0x68, 0x74, 0x6c, 0x79, 0x20, 0x73, 0x69,
	0x6e, 0x63, 0x65, 0x20, 0x4d, 0x61, 0x72, 0x63, 0x20, 0x50,
	0x65, 0x74, 0x65, 0x72, 0x20, 0x77, 0x72, 0x69, 0x74, 0x65,
	0x20, 0x74, 0x68, 0x65, 0x20, 0x4a, 0x49, 0x54, 0x20, 0x61,
	0x6e, 0x64, 0x20, 0x74, 0x68, 0x65, 0x20, 0x4a, 0x49, 0x54,
	0x20, 0x64, 0x6f, 0x65, 0x73, 0x20, 0x63, 0x75, 0x72, 0x72,
	0x65, 0x6e, 0x74, 0x6c, 0x79, 0x20, 0x6e, 0x6f, 0x74, 0x20,
	0x68, 0x61, 0x6e, 0x64, 0x6c, 0x65, 0x0d, 0x0a, 0x74, 0x68,
	0x65, 0x20, 0x22, 0x73, 0x6c, 0x65, 0x65, 0x70, 0x22, 0x20,
	0x69, 0x6e, 0x73, 0x74, 0x72, 0x75, 0x63, 0x74, 0x69, 0x6f,
	0x6e, 0x20, 0x63, 0x6f, 0x72, 0x72, 0x65, 0x63, 0x74, 0x6c,
	0x79, 0x2e, 0x0d, 0x0a, 0x0d, 0x0a, 0x54, 0x68, 0x65, 0x20,
	0x70, 0x6f, 0x77, 0x65, 0x72, 0x20, 0x75, 0x73, 0x65, 0x72,
	0x20, 0x44, 0x61, 0x76, 0x69, 0x64, 0x20, 0x22, 0x42, 0x61,
	0x69, 0x6c, 0x6f, 0x70, 0x61, 0x6e, 0x22, 0x20, 0x41, 0x6e,
	0x64, 0x65, 0x72, 0x73, 0x6f, 0x6e, 0x20, 0x28, 0x73, 0x65,
	0x65, 0x20, 0x77, 0x77, 0x77, 0x2e, 0x62, 0x61, 0x69, 0x6c,
	0x6f, 0x70, 0x61, 0x6e, 0x2e, 0x6e, 0x65, 0x74, 0x29, 0x20,
	0x66, 0x6f, 0x75, 0x6e, 0x64, 0x20, 0x6d, 0x61, 0x6e, 0x79,
	0x20, 0x62, 0x75, 0x67, 0x73, 0x0d, 0x0a, 0x69, 0x6e, 0x20,
	0x50, 0x61, 0x77, 0x6e, 0x2c, 0x20, 0x61, 0x6e, 0x64, 0x20,
	0x70, 0x72, 0x6f, 0x76, 0x69, 0x64, 0x65, 0x64, 0x20, 0x70,
	0x61, 0x74, 0x63, 0x68, 0x65, 0x73, 0x20, 0x61, 0x6e, 0x64,
	0x20, 0x64, 0x65, 0x74, 0x61, 0x69, 0x6c, 0x65, 0x64, 0x20,
	0x72, 0x65, 0x70, 0x6f, 0x72, 0x74, 0x73, 0x2e, 0x20, 0x48,
	0x65, 0x20, 0x61, 0x6e, 0x64, 0x20, 0x68, 0x69, 0x73, 0x20,
	0x74, 0x65, 0x61, 0x6d, 0x20, 0x61, 0x6c, 0x73, 0x6f, 0x0d,
	0x0a, 0x70, 0x72, 0x6f, 0x76, 0x69, 0x64, 0x65, 0x64, 0x20,
	0x61, 0x20, 0x6e, 0x65, 0x77, 0x20, 0x22, 0x6d, 0x65, 0x6d,
	0x6f, 0x72, 0x79, 0x20, 0x66, 0x69, 0x6c, 0x65, 0x22, 0x20,
	0x6d, 0x6f, 0x64, 0x75, 0x6c, 0x65, 0x20, 0x74, 0x68, 0x61,
	0x74, 0x20, 0x6d, 0x61, 0x6b, 0x65, 0x20, 0x74, 0x68, 0x65,
	0x20, 0x63, 0x6f, 0x6d, 0x70, 0x69, 0x6c, 0x65, 0x72, 0x20,
	0x70, 0x72, 0x6f, 0x63, 0x65, 0x73, 0x73, 0x20, 0x6c, 0x61,
	0x72, 0x67, 0x65, 0x20, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74,
	0x73, 0x0d, 0x0a, 0x71, 0x75, 0x69, 0x63, 0x6b, 0x65, 0x72,
	0x2e, 0x0d, 0x0a, 0x0d, 0x0a, 0x47, 0x2e, 0x57, 0x2e, 0x4d,
	0x2e, 0x20, 0x56, 0x69, 0x73, 0x73, 0x65, 0x72, 0x73, 0x20,
	0x74, 0x72, 0x61, 0x6e, 0x73, 0x6c, 0x61, 0x74, 0x65, 0x64,
	0x20, 0x4d, 0x61, 0x72, 0x63, 0x20, 0x50, 0x65, 0x74, 0x65,
	0x72, 0x27, 0x73, 0x20, 0x4a, 0x49, 0x54, 0x20, 0x74, 0x6f,
	0x20, 0x4e, 0x41, 0x53, 0x4d, 0x2e, 0x20, 0x54, 0x68, 0x69,
	0x73, 0x20, 0x6d, 0x61, 0x6b, 0x65, 0x73, 0x20, 0x74, 0x68,
	0x65, 0x20, 0x4a, 0x49, 0x54, 0x20, 0x61, 0x76, 0x61, 0x69,
	0x6c, 0x61, 0x62, 0x6c, 0x65, 0x0d, 0x0a, 0x74, 0x6f, 0x20,
	0x4c, 0x69, 0x6e, 0x75, 0x78, 0x20, 0x61, 0x6e, 0x64, 0x20,
	0x55, 0x6e, 0x69, 0x78, 0x2d, 0x6c, 0x69, 0x6b, 0x65, 0x20,
	0x70, 0x6c, 0x61, 0x74, 0x66, 0x6f, 0x72, 0x6d, 0x73, 0x2e,
	0x0d, 0x0a, 0x0d, 0x0a, 0x47, 0x72, 0x65, 0x67, 0x20, 0x47,
	0x61, 0x72, 0x6e, 0x65, 0x72, 0x20, 0x66, 0x72, 0x6f, 0x6d,
	0x20, 0x41, 0x72, 0x74, 0x72, 0x61, 0x6e, 0x20, 0x49, 0x6e,
	0x63, 0x2e, 0x20, 0x63, 0x6f, 0x6d, 0x70, 0x69, 0x6c, 0x65,
	0x64, 0x20, 0x74, 0x68, 0x65, 0x20, 0x73, 0x6f, 0x75, 0x72,
	0x63, 0x65, 0x20, 0x66, 0x69, 0x6c, 0x65, 0x73, 0x20, 0x61,
	0x73, 0x20, 0x43, 0x2b, 0x2b, 0x20, 0x66, 0x69, 0x6c, 0x65,
	0x73, 0x20, 0x28, 0x72, 0x61, 0x74, 0x68, 0x65, 0x72, 0x0d,
	0x0a, 0x74, 0x68, 0x61, 0x6e, 0x20, 0x43, 0x29, 0x2c, 0x20,
	0x61, 0x64, 0x64, 0x65, 0x64, 0x20, 0x74, 0x79, 0x70, 0x65,
	0x20, 0x63, 0x61, 0x73, 0x74, 0x73, 0x20, 0x77, 0x68, 0x65,
	0x72, 0x65, 0x20, 0x6e, 0x65, 0x65, 0x64, 0x65, 0x64, 0x20,
	0x61, 0x6e, 0x64, 0x20, 0x66, 0x69, 0x78, 0x65, 0x64, 0x20,
	0x74, 0x77, 0x6f, 0x20, 0x62, 0x75, 0x67, 0x73, 0x20, 0x69,
	0x6e, 0x20, 0x74, 0x68, 0x65, 0x20, 0x50, 0x61, 0x77, 0x6e,
	0x20, 0x63, 0x6f, 0x6d, 0x70, 0x69, 0x6c, 0x65, 0x72, 0x0d,
	0x0a, 0x69, 0x6e, 0x20, 0x74, 0x68, 0x65, 0x20, 0x70, 0x72,
	0x6f, 0x63, 0x65, 0x73, 0x73, 0x2e, 0x20, 0x47, 0x72, 0x65,
	0x67, 0x20, 0x47, 0x61, 0x72, 0x6e, 0x65, 0x72, 0x20, 0x61,
	0x6c, 0x73, 0x6f, 0x20, 0x77, 0x72, 0x6f, 0x74, 0x65, 0x20,
	0x28, 0x61, 0x6e, 0x64, 0x20, 0x63, 0x6f, 0x6e, 0x74, 0x72,
	0x69, 0x62, 0x75, 0x74, 0x65, 0x64, 0x29, 0x20, 0x74, 0x68,
	0x65, 0x20, 0x65, 0x78, 0x74, 0x65, 0x6e, 0x73, 0x69, 0x6f,
	0x6e, 0x20, 0x6d, 0x6f, 0x64, 0x75, 0x6c, 0x65, 0x0d, 0x0a,
	0x66, 0x6f, 0x72, 0x20, 0x66, 0x6c, 0x6f, 0x61, 0x74, 0x69,
	0x6e, 0x67, 0x20, 0x70, 0x6f, 0x69, 0x6e, 0x74, 0x20, 0x73,
	0x75, 0x70, 0x70, 0x6f, 0x72, 0x74, 0x20, 0x28, 0x66, 0x69,
	0x6c, 0x65, 0x73, 0x20, 0x46, 0x4c, 0x4f, 0x41, 0x54, 0x2e,
	0x43, 0x50, 0x50, 0x20, 0x61, 0x6e, 0x64, 0x20, 0x46, 0x4c,
	0x4f, 0x41, 0x54, 0x2e, 0x49, 0x4e, 0x43, 0x29, 0x2e, 0x20,
	0x49, 0x20, 0x61, 0x6d, 0x20, 0x63, 0x75, 0x72, 0x72, 0x65,
	0x6e, 0x74, 0x6c, 0x79, 0x0d, 0x0a, 0x6d, 0x61, 0x69, 0x6e,
	0x74, 0x61, 0x69, 0x6e, 0x69, 0x6e, 0x67, 0x20, 0x74, 0x68,
	0x65, 0x73, 0x65, 0x20, 0x6d, 0x6f, 0x64, 0x75, 0x6c, 0x65,
	0x73, 0x2c, 0x20, 0x69, 0x6e, 0x20, 0x6f, 0x72, 0x64, 0x65,
	0x72, 0x20, 0x74, 0x6f, 0x20, 0x6b, 0x65, 0x65, 0x70, 0x20,
	0x74, 0x68, 0x65, 0x6d, 0x20, 0x75, 0x70, 0x20, 0x74, 0x6f,
	0x20, 0x64, 0x61, 0x74, 0x65, 0x20, 0x77, 0x69, 0x74, 0x68,
	0x20, 0x6e, 0x65, 0x77, 0x20, 0x66, 0x65, 0x61, 0x74, 0x75,
	0x72, 0x65, 0x73, 0x0d, 0x0a, 0x69, 0x6e, 0x20, 0x74, 0x68,
	0x65, 0x20, 0x50, 0x61, 0x77, 0x6e, 0x20, 0x74, 0x6f, 0x6f,
	0x6c, 0x6b, 0x69, 0x74, 0x2e, 0x0d, 0x0a, 0x0d, 0x0a, 0x44,
	0x69, 0x65, 0x74, 0x65, 0x72, 0x20, 0x4e, 0x65, 0x75, 0x62,
	0x61, 0x75, 0x65, 0x72, 0x20, 0x6d, 0x61, 0x64, 0x65, 0x20,
	0x61, 0x20, 0x31, 0x36, 0x2d, 0x62, 0x69, 0x74, 0x20, 0x76,
	0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x20, 0x6f, 0x66, 0x20,
	0x74, 0x68, 0x65, 0x20, 0x50, 0x61, 0x77, 0x6e, 0x20, 0x74,
	0x6f, 0x6f, 0x6c, 0x73, 0x20, 0x28, 0x6d, 0x65, 0x61, 0x6e,
	0x69, 0x6e, 0x67, 0x20, 0x74, 0x68, 0x61, 0x74, 0x20, 0x61,
	0x20, 0x63, 0x65, 0x6c, 0x6c, 0x0d, 0x0a, 0x69, 0x73, 0x20,
	0x31, 0x36, 0x2d, 0x62, 0x69, 0x74, 0x2c, 0x20, 0x69, 0x6e,
	0x73, 0x74, 0x65, 0x61, 0x64, 0x20, 0x6f, 0x66, 0x20, 0x74,
	0x68, 0x65, 0x20, 0x64, 0x65, 0x66, 0x61, 0x75, 0x6c, 0x74,
	0x20, 0x33, 0x32, 0x2d, 0x62, 0x69, 0x74, 0x29, 0x2e, 0x20,
	0x48, 0x69, 0x73, 0x20, 0x63, 0x68, 0x61, 0x6e, 0x67, 0x65,
	0x73, 0x20, 0x77, 0x65, 0x72, 0x65, 0x20, 0x6d, 0x65, 0x72,
	0x67, 0x65, 0x64, 0x20, 0x69, 0x6e, 0x20, 0x74, 0x68, 0x65,
	0x0d, 0x0a, 0x6f, 0x72, 0x69, 0x67, 0x69, 0x6e, 0x61, 0x6c,
	0x20, 0x64, 0x69, 0x73, 0x74, 0x72, 0x69, 0x62, 0x75, 0x74,
	0x69, 0x6f, 0x6e, 0x2e, 0x20, 0x4e, 0x6f, 0x74, 0x65, 0x20,
	0x74, 0x68, 0x61, 0x74, 0x20, 0x66, 0x69, 0x78, 0x65, 0x64,
	0x20, 0x6f, 0x72, 0x20, 0x66, 0x6c, 0x6f, 0x61, 0x74, 0x69,
	0x6e, 0x67, 0x20, 0x70, 0x6f, 0x69, 0x6e, 0x74, 0x20, 0x61,
	0x72, 0x69, 0x74, 0x68, 0x6d, 0x65, 0x74, 0x69, 0x63, 0x20,
	0x77, 0x69, 0x6c, 0x6c, 0x20, 0x62, 0x65, 0x0d, 0x0a, 0x6e,
	0x65, 0x61, 0x72, 0x20, 0x74, 0x6f, 0x20, 0x69, 0x6d, 0x70,
	0x6f, 0x73, 0x73, 0x69, 0x62, 0x6c, 0x65, 0x20, 0x77, 0x69,
	0x74, 0x68, 0x20, 0x61, 0x20, 0x31, 0x36, 0x2d, 0x62, 0x69,
	0x74, 0x20, 0x63, 0x65, 0x6c, 0x6c, 0x2e, 0x0d, 0x0a, 0x0d,
	0x0a, 0x52, 0x6f, 0x62, 0x65, 0x72, 0x74, 0x20, 0x44, 0x61,
	0x6e, 0x69, 0x65, 0x6c, 0x73, 0x20, 0x70, 0x6f, 0x72, 0x74,
	0x65, 0x64, 0x20, 0x50, 0x61, 0x77, 0x6e, 0x20, 0x74, 0x6f,
	0x20, 0x75, 0x63, 0x4c, 0x69, 0x6e, 0x75, 0x78, 0x20, 0x61,
	0x6e, 0x64, 0x20, 0x63, 0x6f, 0x72, 0x72, 0x65, 0x63, 0x74,
	0x65, 0x64, 0x20, 0x61, 0x20, 0x66, 0x65, 0x77, 0x20, 0x65,
	0x72, 0x72, 0x6f, 0x72, 0x73, 0x20, 0x74, 0x68, 0x61, 0x74,
	0x20, 0x68, 0x61, 0x64, 0x20, 0x74, 0x6f, 0x0d, 0x0a, 0x64,
	0x6f, 0x20, 0x77, 0x69, 0x74, 0x68, 0x20, 0x74, 0x68, 0x65,
	0x20, 0x22, 0x45, 0x6e, 0x64, 0x69, 0x61, 0x6e, 0x6e, 0x65,
	0x73, 0x73, 0x22, 0x20, 0x6f, 0x66, 0x20, 0x74, 0x68, 0x65,
	0x20, 0x43, 0x50, 0x55, 0x2e, 0x20, 0x48, 0x69, 0x73, 0x20,
	0x63, 0x6f, 0x72, 0x72, 0x65, 0x63, 0x74, 0x69, 0x6f, 0x6e,
	0x73, 0x20, 0x6d, 0x61, 0x6b, 0x65, 0x20, 0x74, 0x68, 0x65,
	0x20, 0x50, 0x61, 0x77, 0x6e, 0x20, 0x63, 0x6f, 0x6d, 0x70,
	0x69, 0x6c, 0x65, 0x72, 0x0d, 0x0a, 0x61, 0x6e, 0x64, 0x20,
	0x61, 0x62, 0x73, 0x74, 0x72, 0x61, 0x63, 0x74, 0x20, 0x6d,
	0x61, 0x63, 0x68, 0x69, 0x6e, 0x65, 0x20, 0x62, 0x65, 0x74,
	0x74, 0x65, 0x72, 0x20, 0x70, 0x6f, 0x72, 0x74, 0x61, 0x62,
	0x6c, 0x65, 0x20, 0x74, 0x6f, 0x20, 0x42, 0x69, 0x67, 0x20,
	0x45, 0x6e, 0x64, 0x69, 0x61, 0x6e, 0x20, 0x6d, 0x61, 0x63,
	0x68, 0x69, 0x6e, 0x65, 0x73, 0x2e, 0x0d, 0x0a, 0x0d, 0x0a,
	0x46, 0x72, 0x61, 0x6e, 0x6b, 0x20, 0x43, 0x6f, 0x6e, 0x64,
	0x65, 0x6c, 0x6c, 0x6f, 0x20, 0x6d, 0x61, 0x64, 0x65, 0x20,
	0x61, 0x20, 0x70, 0x6f, 0x72, 0x74, 0x20, 0x6f, 0x66, 0x20,
	0x74, 0x68, 0x65, 0x20, 0x50, 0x61, 0x77, 0x6e, 0x20, 0x74,
	0x6f, 0x6f, 0x6c, 0x6b, 0x69, 0x74, 0x20, 0x74, 0x6f, 0x20,
	0x4d, 0x61, 0x63, 0x4f, 0x53, 0x20, 0x28, 0x43, 0x46, 0x4d,
	0x20, 0x43, 0x61, 0x72, 0x62, 0x6f, 0x6e, 0x29, 0x2e, 0x20,
	0x48, 0x69, 0x73, 0x0d, 0x0a, 0x63, 0x68, 0x61, 0x6e, 0x67,
	0x65, 0x73, 0x20, 0x61, 0x72, 0x65, 0x20, 0x6d, 0x65, 0x72,
	0x67, 0x65, 0x64, 0x20, 0x69, 0x6e, 0x74, 0x6f, 0x20, 0x74,
	0x68, 0x65, 0x20, 0x6d, 0x61, 0x69, 0x6e, 0x20, 0x73, 0x6f,
	0x75, 0x72, 0x63, 0x65, 0x20, 0x74, 0x72, 0x75, 0x6e, 0x6b,
	0x2e, 0x0d, 0x0a, 0x0a
};

static x_s32 test(x_s32 argc, const x_s8 **argv)
{
	x_s32 fd;
	x_s32 n;
	char buf[512];
	int i;
	struct blkdev * dev;

	if(argc == 1)
	{
		fd = open("test.ar", O_WRONLY | O_CREAT | O_TRUNC, (S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH));
		if(fd < 0)
			return -1;

		n = write(fd, (void *)test_ar, 2644);
		if( n != 2644 )
		{
			close(fd);
			unlink("test.ar");
			printk("failed to write test.ar\r\n");
		}
		close(fd);
		printk("write test.ar\r\n");

		if(!register_loop("test.ar"))
		{
			printk("register a loop block device fail\r\n");
			return -1;
		}

		if(search_loop("test.ar") == NULL)
		{
			printk("special loop block device not found\r\n");
			return -1;
		}
	}
	else
	{
		dev = search_blkdev_with_type("loop0", BLK_DEV_LOOP);
		if(!dev)
		{
			printk("dev null");
			return -1;
		}

		dev->open(dev);

		printk("bio read\r\n");

		memset(buf, 0, sizeof(buf));

		bio_read(dev, (x_u8 *)buf, 0x7fd, 10);

		for(i = 0; i < 10; i++)
		{
			printk(" 0x%02x", buf[i]);
		}
		printk("\r\n");

		bio_flush(dev);

		dev->close(dev);
	}

	return 0;
}

static struct command test_cmd = {
	.name		= "test",
	.func		= test,
	.desc		= "test command for debug\r\n",
	.usage		= "test [arg ...]\r\n",
	.help		= "    test command for debug software by programmer.\r\n"
};

static __init void test_cmd_init(void)
{
	if(!command_register(&test_cmd))
		LOG_E("register 'test' command fail");
}

static __exit void test_cmd_exit(void)
{
	if(!command_unregister(&test_cmd))
		LOG_E("unregister 'test' command fail");
}

module_init(test_cmd_init, LEVEL_COMMAND);
module_exit(test_cmd_exit, LEVEL_COMMAND);

#endif
